---
title: "GEOG458_GroupLab1"
author: "Group6"
date: "1/16/2019"
output: html_document
---
##Eddie's part

##Section 1, Question 1
Beijing and Shanghai are considered as "Direct Controlled Municipality", which means they are not a province, and are directly controlled or managed by the chinese central government. Hong Kong, Macao, and Taiwan are missing from the dataset. This is because the Chinese centrol government allowed them to have their own government. However, their own government will be managed by the Chinese centrol government. Using Hong Kong as an example, Hong Kong has it own government called Hong Kong SAR Government, and the adminitrive head is called cheif executive. The chief executive will be selected by the Hong Kong residences. After the candidate is finalized, the Chinese government will review his qualifications. Once approved, he/she will be the formal cheif executive of Hong Kong. Some people may argue whether Taiwan is still part of China. The answer is yes, but so far the Taiwan government doesn't recognize the Chinese Communism Party as the leader of their government. The [1992 Consensus](https://en.wikipedia.org/wiki/1992_Consensus) can be the support of this claim. 

##Section 2, Question 2. One of the five visualizations

```{r, echo = TRUE, warning=FALSE,message=FALSE}
library(plyr)
library(dplyr)
library(tidyverse)
library(ggplot2)
library(reshape2)


```

```{r setup, echo=TRUE}
##Only selecting the Direct Controlled Municipality's company econ data

econData <- as_tibble(read.csv("China_EO_49to17.csv"))

DirectCity<- econData %>%
  select(Beijing_Enterprise, Shanghai_Enterprise, Tianjin_Enterprise, Chongqing_Enterprise, Year)%>%
  filter(Year >= 2000)
names(DirectCity) <- c("Beijing", "Shanghai", "Tianjin", "Chongqing", "Year")

meltDirectCity <- melt(DirectCity, id.vars = "Year")

ggplot(meltDirectCity, aes(x = Year, y = value, colour = variable)) + geom_point() + scale_size_area()+ stat_smooth(method = lm, formula = y ~ splines::bs(x, 3), se = FALSE)


```

##Task 3, question 2
```{r, echo=TRUE}

##Sum national total 
NationalOutput <- econData %>%
  select(matches("output"), Year) %>%
  mutate(sumVar=rowSums(.[1:19], na.rm = TRUE))

##Inner join national total with the csv file

df_with_Total<- left_join(econData, NationalOutput, by = "Year")
df_with_Total<- df_with_Total %>%
  select(-matches(".y"))

##trying to building a new data frame to store the percentage


Total_Output<- econData$sumVar
year<- econData$Year

## prototype to get the percentage
Ratio_Beijing <- econData$Beijing_Output/econData$sumVar
Ratio_Tianjin <- econData$Tianjin_Output.x/econData$sumVar
Ratio_Hebei <- econData$Hebei_Output.x/econData$sumVar
Ratio_Shanxi <- econData$Shanxi_Output.x/econData$sumVar
Ratio_InnerMangolia <- econData$InnerMongolia_Output.x/econData$sumVar
Ratio_LiaoNing<- econData$Liaoning_Output.x/econData$sumVar
Ratio_JiLin<-econData$Jilin_Output.x/econData$sumVar
Ratio_HeiLongJiang<- econData$Heilongjiang_Output.x/econData$sumVar
Ratio_Shanghai<-econData$Shaanxi_Output.x/econData$sumVar
Ratio_JiangSu<-econData$Jiangsu_Output.x/econData$sumVar
Ratio_ZheJiang<-econData$Zhejiang_Output.x/econData$sumVar
Ratio_AnHui<-econData$Anhui_Output.x/econData$sumVar
Ratio_Fujian<-econData$Fujian_Output.x/econData$sumVar
Ratio_JiangXi<-econData$Jiangxi_Output.x/econData$sumVar
Ratio_ShangDong<-econData$Shandong_Output.x/econData$sumVar
Ratio_HeNan<-econData$Henan_Output.x/econData$sumVar
Ratio_Hubei<-econData$Hubei_Output.x/econData$sumVar
Ratio_Hunan<-econData$Hunan_Output.x/econData$sumVar
Ratio_Guangdong<-econData$Guangdong_Output.x/econData$sumVar
Ratio_Guangxi<-econData$Guangxi_Output.x/econData$sumVar
Ratio_Hainan<-econData$Hainan_Output.x/econData$sumVar
Ratio_Chongqing<-econData$Chongqing_Output.x/econData$sumVar
Ratio_Sichuan <- econData$Sichuan_Output.x/econData$sumVar
Ratio_Guizhou <- econData$Guizhou_Output.x/econData$sumVar
Ratio_Yunnan <- econData$Guizhou_Output.x/econData$sumVar
Ratio_Tibet <- econData$Guizhou_Output.x/econData$sumVar
Ratio_Shaanxi <- econData$Shaanxi_Output.x/econData$sumVar
Ratio_Gansu <- econData$Gansu_Output.x/econData$sumVar
Ratio_Qinghai <- econData$Qinghai_Output.x/econData$sumVar
Ratio_Ningxia <- econData$Ningxia_Output.x/econData$sumVar

Province_National_Output_Ratio <- data.frame(year, Ratio_Beijing, Ratio_AnHui, Ratio_Chongqing, ratio)

##the actual loop. The idea is using column, eg Beijing_Output / sumVar. The sumVar is constant, and the Beijing_output can be symbolized as df[,i]. I think I need to add new columns with different name to store the ratio data for each province, but seems like the add_column function doesn't allow additional functions like paste? 

NationalOutput <- as_tibble(NationalOutput)

for(i in 1:dim(NationalOutput)[2]-1){
  temp <- NationalOutput %>%
    mutate( NationalOutput[paste0(i, "_share")] = NationalOutput[i] / NationalOutput$sumVar )
}
x <- dim(NationalOutput)
for(col in names(NationalOutput)) {
  NationalOutput[paste0(col, "_share")] = NationalOutput[col] / NationalOutput$sumVar
}



```
